{
  "component_type": "Flow",
  "id": "0facfa1b-11ac-4fcd-b95b-61955a94353e",
  "name": "Generate code and review flow",
  "description": "Flow that given a user request, generates a python code snippet to satisfy it and passes it through a code review before returning it",
  "metadata": {},
  "inputs": [
    {
      "title": "user_request",
      "type": "string"
    }
  ],
  "outputs": [
    {
      "title": "code",
      "type": "string",
      "default": ""
    }
  ],
  "start_node": {
    "$component_ref": "df5db1b8-528f-4fc9-918f-889677bf154b"
  },
  "nodes": [
    {
      "$component_ref": "df5db1b8-528f-4fc9-918f-889677bf154b"
    },
    {
      "$component_ref": "a97259f8-8be3-42ac-9909-e21cdd07e9a5"
    },
    {
      "$component_ref": "52049362-86df-400d-ab95-112ce0d045dc"
    },
    {
      "$component_ref": "e7c5ca9a-a008-43c0-93f2-efc337a01d90"
    },
    {
      "$component_ref": "075642ba-b177-428d-939f-3b1e16def02c"
    },
    {
      "$component_ref": "3fb86623-80d5-40aa-9362-88b778c61e9b"
    }
  ],
  "control_flow_connections": [
    {
      "component_type": "ControlFlowEdge",
      "id": "e98a0f0f-6372-4f4b-8c5c-1e61c5fdb677",
      "name": "start_to_generate_code_control_edge",
      "description": null,
      "metadata": {},
      "from_node": {
        "$component_ref": "df5db1b8-528f-4fc9-918f-889677bf154b"
      },
      "from_branch": null,
      "to_node": {
        "$component_ref": "a97259f8-8be3-42ac-9909-e21cdd07e9a5"
      }
    },
    {
      "component_type": "ControlFlowEdge",
      "id": "22705617-f433-4f66-bb75-8ff1e35fed1c",
      "name": "generate_code_to_review_control_edge",
      "description": null,
      "metadata": {},
      "from_node": {
        "$component_ref": "a97259f8-8be3-42ac-9909-e21cdd07e9a5"
      },
      "from_branch": null,
      "to_node": {
        "$component_ref": "52049362-86df-400d-ab95-112ce0d045dc"
      }
    },
    {
      "component_type": "ControlFlowEdge",
      "id": "c65c4d53-42cd-43fb-9faf-1138a23f49dc",
      "name": "review_to_is_code_ready_decision_control_edge",
      "description": null,
      "metadata": {},
      "from_node": {
        "$component_ref": "52049362-86df-400d-ab95-112ce0d045dc"
      },
      "from_branch": null,
      "to_node": {
        "$component_ref": "e7c5ca9a-a008-43c0-93f2-efc337a01d90"
      }
    },
    {
      "component_type": "ControlFlowEdge",
      "id": "770ee2ef-9ec4-42e3-b323-767219d3ebe2",
      "name": "is_code_ready_decision_to_is_code_ready_branching_control_edge",
      "description": null,
      "metadata": {},
      "from_node": {
        "$component_ref": "e7c5ca9a-a008-43c0-93f2-efc337a01d90"
      },
      "from_branch": null,
      "to_node": {
        "$component_ref": "075642ba-b177-428d-939f-3b1e16def02c"
      }
    },
    {
      "component_type": "ControlFlowEdge",
      "id": "9763ebfe-e4ce-41e1-98fe-e1c34ca60705",
      "name": "is_code_ready_branching_to_end_control_edge",
      "description": null,
      "metadata": {},
      "from_node": {
        "$component_ref": "075642ba-b177-428d-939f-3b1e16def02c"
      },
      "from_branch": "yes",
      "to_node": {
        "$component_ref": "3fb86623-80d5-40aa-9362-88b778c61e9b"
      }
    },
    {
      "component_type": "ControlFlowEdge",
      "id": "f5186c2a-f5df-4a41-a116-a6a1aa869d68",
      "name": "is_code_ready_branching_to_generate_code_control_edge",
      "description": null,
      "metadata": {},
      "from_node": {
        "$component_ref": "075642ba-b177-428d-939f-3b1e16def02c"
      },
      "from_branch": "no",
      "to_node": {
        "$component_ref": "a97259f8-8be3-42ac-9909-e21cdd07e9a5"
      }
    }
  ],
  "data_flow_connections": [
    {
      "component_type": "DataFlowEdge",
      "id": "1ba462c6-905f-4f1b-b26c-c8d5cb95df06",
      "name": "start_to_generate_code_user_request_data_edge",
      "description": null,
      "metadata": {},
      "source_node": {
        "$component_ref": "df5db1b8-528f-4fc9-918f-889677bf154b"
      },
      "source_output": "user_request",
      "destination_node": {
        "$component_ref": "a97259f8-8be3-42ac-9909-e21cdd07e9a5"
      },
      "destination_input": "user_request"
    },
    {
      "component_type": "DataFlowEdge",
      "id": "4f2924f2-fb71-4a11-abad-204a7cdcaeca",
      "name": "generate_code_to_end_code_data_edge",
      "description": null,
      "metadata": {},
      "source_node": {
        "$component_ref": "a97259f8-8be3-42ac-9909-e21cdd07e9a5"
      },
      "source_output": "code",
      "destination_node": {
        "$component_ref": "3fb86623-80d5-40aa-9362-88b778c61e9b"
      },
      "destination_input": "code"
    },
    {
      "component_type": "DataFlowEdge",
      "id": "8c2d7b8f-2bdd-4119-a047-2f692d54c4ec",
      "name": "generate_code_to_generate_code_code_data_edge",
      "description": null,
      "metadata": {},
      "source_node": {
        "$component_ref": "a97259f8-8be3-42ac-9909-e21cdd07e9a5"
      },
      "source_output": "code",
      "destination_node": {
        "$component_ref": "a97259f8-8be3-42ac-9909-e21cdd07e9a5"
      },
      "destination_input": "code"
    },
    {
      "component_type": "DataFlowEdge",
      "id": "e299c1e1-570f-4b8a-aa75-0a4b2af3bb22",
      "name": "generate_code_to_review_code_data_edge",
      "description": null,
      "metadata": {},
      "source_node": {
        "$component_ref": "a97259f8-8be3-42ac-9909-e21cdd07e9a5"
      },
      "source_output": "code",
      "destination_node": {
        "$component_ref": "52049362-86df-400d-ab95-112ce0d045dc"
      },
      "destination_input": "code"
    },
    {
      "component_type": "DataFlowEdge",
      "id": "6ab1d280-197b-4f9f-85d6-b12512e63b6c",
      "name": "review_code_to_generate_code_review_data_edge",
      "description": null,
      "metadata": {},
      "source_node": {
        "$component_ref": "52049362-86df-400d-ab95-112ce0d045dc"
      },
      "source_output": "review",
      "destination_node": {
        "$component_ref": "a97259f8-8be3-42ac-9909-e21cdd07e9a5"
      },
      "destination_input": "review"
    },
    {
      "component_type": "DataFlowEdge",
      "id": "e01a059a-3745-46f6-a249-b080bca5466d",
      "name": "review_code_to_is_code_ready_review_data_edge",
      "description": null,
      "metadata": {},
      "source_node": {
        "$component_ref": "52049362-86df-400d-ab95-112ce0d045dc"
      },
      "source_output": "review",
      "destination_node": {
        "$component_ref": "e7c5ca9a-a008-43c0-93f2-efc337a01d90"
      },
      "destination_input": "review"
    },
    {
      "component_type": "DataFlowEdge",
      "id": "9e499cf0-cf9f-44c8-8ad8-02ce8bb75832",
      "name": "review_code_to_is_code_ready_flag_data_edge",
      "description": null,
      "metadata": {},
      "source_node": {
        "$component_ref": "e7c5ca9a-a008-43c0-93f2-efc337a01d90"
      },
      "source_output": "is_code_ready",
      "destination_node": {
        "$component_ref": "075642ba-b177-428d-939f-3b1e16def02c"
      },
      "destination_input": "is_code_ready"
    }
  ],
  "$referenced_components": {
    "a97259f8-8be3-42ac-9909-e21cdd07e9a5": {
      "component_type": "LlmNode",
      "id": "a97259f8-8be3-42ac-9909-e21cdd07e9a5",
      "name": "Generate code node",
      "description": null,
      "metadata": {},
      "inputs": [
        {
          "title": "user_request",
          "type": "string"
        },
        {
          "title": "code",
          "type": "string",
          "default": ""
        },
        {
          "title": "review",
          "type": "string",
          "default": ""
        }
      ],
      "outputs": [
        {
          "title": "code",
          "type": "string",
          "default": ""
        }
      ],
      "branches": [
        "next"
      ],
      "llm_config": {
        "$component_ref": "4401c9a2-d5d3-409e-a2c1-e7f8a83c4570"
      },
      "prompt_template": "You are a great code python software engineer.\n\n    Please write the python code to satisfy the following user request: \"{{user_request}}\".\n\n    You previously generated the following snippet of code:\n    ```\n    {{code}}\n    ```\n    Take inspiration from the snippet of code.\n\n    The code reviewer gave the following feedback:\n    {{review}}\n    Take also into account the comments in the review\n\n    Write only the python code.\n    "
    },
    "4401c9a2-d5d3-409e-a2c1-e7f8a83c4570": {
      "component_type": "VllmConfig",
      "id": "4401c9a2-d5d3-409e-a2c1-e7f8a83c4570",
      "name": "Vllm model",
      "description": null,
      "metadata": {},
      "default_generation_parameters": null,
      "url": "vllm_url",
      "model_id": "model_id"
    },
    "df5db1b8-528f-4fc9-918f-889677bf154b": {
      "component_type": "StartNode",
      "id": "df5db1b8-528f-4fc9-918f-889677bf154b",
      "name": "Start node",
      "description": null,
      "metadata": {},
      "inputs": [
        {
          "title": "user_request",
          "type": "string"
        }
      ],
      "outputs": [
        {
          "title": "user_request",
          "type": "string"
        }
      ],
      "branches": [
        "next"
      ]
    },
    "52049362-86df-400d-ab95-112ce0d045dc": {
      "component_type": "LlmNode",
      "id": "52049362-86df-400d-ab95-112ce0d045dc",
      "name": "Review code node",
      "description": null,
      "metadata": {},
      "inputs": [
        {
          "title": "code",
          "type": "string",
          "default": ""
        }
      ],
      "outputs": [
        {
          "title": "review",
          "type": "string",
          "default": ""
        }
      ],
      "branches": [
        "next"
      ],
      "llm_config": {
        "$component_ref": "4401c9a2-d5d3-409e-a2c1-e7f8a83c4570"
      },
      "prompt_template": "You are a great code python software engineer, and a highly skilled code reviewer.\n    Please review the following snippet of python code:\n    ```\n    {{code}}\n    ```\n    "
    },
    "e7c5ca9a-a008-43c0-93f2-efc337a01d90": {
      "component_type": "LlmNode",
      "id": "e7c5ca9a-a008-43c0-93f2-efc337a01d90",
      "name": "Check if code is ready node",
      "description": null,
      "metadata": {},
      "inputs": [
        {
          "title": "review",
          "type": "string",
          "default": ""
        }
      ],
      "outputs": [
        {
          "title": "is_code_ready",
          "type": "boolean",
          "default": false
        }
      ],
      "branches": [
        "next"
      ],
      "llm_config": {
        "$component_ref": "4401c9a2-d5d3-409e-a2c1-e7f8a83c4570"
      },
      "prompt_template": "You are a software engineer with 20 years of experience. You have to take a decision.\n    Based on the following code review, do you think that the code is ready to be deployed?\n    ```\n    {{review}}\n    ```\n    Please answer only with `yes` or `no`.\n    "
    },
    "075642ba-b177-428d-939f-3b1e16def02c": {
      "component_type": "BranchingNode",
      "id": "075642ba-b177-428d-939f-3b1e16def02c",
      "name": "Is code ready branching node",
      "description": null,
      "metadata": {},
      "inputs": [
        {
          "title": "is_code_ready",
          "type": "boolean",
          "default": false
        }
      ],
      "outputs": [],
      "branches": [
        "default",
        "no",
        "yes"
      ],
      "mapping": {
        "yes": "yes",
        "no": "no"
      }
    },
    "3fb86623-80d5-40aa-9362-88b778c61e9b": {
      "component_type": "EndNode",
      "id": "3fb86623-80d5-40aa-9362-88b778c61e9b",
      "name": "End node",
      "description": null,
      "metadata": {},
      "inputs": [
        {
          "title": "code",
          "type": "string",
          "default": ""
        }
      ],
      "outputs": [
        {
          "title": "code",
          "type": "string",
          "default": ""
        }
      ],
      "branches": [],
      "branch_name": "next"
    }
  },
  "agentspec_version": "25.4.1"
}
