{
  "$referenced_components": {
    // LLM
    "oci_genai_llm": {
      "id": "93b6d1d1",
      "type": "OciGenAiLLM",
      "name": "OCI GenAi LLM",
      "model_id": "command-r-08-2024"
    },

    // Inner flow used in MapNode
    // We omit the definition of the inner nodes and edges for brevity
    "check_item_is_eligible_replacement_flow": {
      "id": "123kahr3412",
      "type": "Flow",
      "name": "Check if an item is an eligible replacement",
      "start_node": {
        "$ref": "inner_start_node"
      },
      "nodes": [
        {
          "$ref": "inner_start_node"
        },
        {
          "$ref": "inner_end_node_add_item"
        },
        {
          "$ref": "inner_end_node_skip_item"
        },
        {
          "$ref": "check_if_item_is_suitable_replacement_node"
        }
      ],
      "control_flow_connections": [
        // ...
      ],
      "data_flow_connections": [
        // ...
      ],
      "inputs": [
        {
          "title": "order",
          "description": "The order information as a dictionary",
          "type": "object",
          "additionalProperties": {
            "type": "string"
          }
        },
        {
          "title": "possible_replacement_item",
          "description": "The item to check",
          "type": "object",
          "additionalProperties": {
            "type": "string"
          }
        }
      ],
      "outputs": [
        {
          "title": "eligible_item",
          "description": "The item if it is eligible as replacement, null otherwise",
          "type": [
            "object",
            null
          ],
          "additionalProperties": {
            "type": "string"
          }
        }
      ]
    },

    // Nodes in the main flow
    "start_node": {
      "id": "8kug123t",
      "type": "StartNode",
      "name": "Start of flow",
      "input_values": [
        {
          "title": "order_id",
          "description": "The order ID",
          "type": "string"
        }
      ],
      "inputs": [
        {
          "title": "order_id",
          "description": "The order ID",
          "type": "string"
        }
      ],
      "outputs": [
        {
          "title": "order_id",
          "description": "The order ID",
          "type": "string"
        }
      ]
    },
    "end_node": {
      "id": "8kug123t",
      "type": "EndNode",
      "name": "End of flow",
      "output_values": [
        {
          "title": "eligible_items_list",
          "description": "The list of items eligible as replacements in this order",
          "type": [
            "array",
            null
          ],
          "default": null,
          "items": {
            "type": "object",
            "additionalProperties": {
              "type": "string"
            }
          }
        }
      ],
      "inputs": [
        {
          "title": "eligible_items_list",
          "description": "The list of items eligible as replacements in this order",
          "type": [
            "array",
            null
          ],
          "default": null,
          "items": {
            "type": "object",
            "additionalProperties": {
              "type": "string"
            }
          }
        }
      ],
      "outputs": [
        {
          "title": "eligible_items_list",
          "description": "The list of items eligible as replacements in this order",
          "type": [
            "array",
            null
          ],
          "default": null,
          "items": {
            "type": "object",
            "additionalProperties": {
              "type": "string"
            }
          }
        }
      ]
    },
    "retrieve_order_info_node": {
      "id": "4db7755a",
      "type": "APINode",
      "name": "Retrieve order information from order ID",
      "url": "https://url.to.my.remote.api/orders/{{order_id}}",
      "http_method": "GET",
      "inputs": [
        {
          "title": "order_id",
          "description": "The order ID",
          "type": "string"
        }
      ],
      "outputs": [
        {
          "title": "order",
          "description": "The order information as a dictionary",
          "type": "object",
          "additionalProperties": {
            "type": "string"
          }
        }
      ]
    },
    "is_order_eligible_for_replacement_node": {
      "id": "4db7755a",
      "type": "LLMNode",
      "name": "Check if order is eligible for replacement",
      "prompt_template": "Given the order, please confirm that it is eligible to get some items replaced. Output yes or no.",
      "llm": {
        "$ref": "oci_genai_llm"
      },
      "inputs": [
        {
          "title": "order",
          "description": "The order information as a dictionary",
          "type": "object",
          "additionalProperties": {
            "type": "string"
          }
        }
      ],
      "outputs": [
        {
          "title": "is_eligible",
          "description": "Yes if the order is eligible for replacement, No otherwise",
          "type": "string"
        }
      ]
    },
    "retrieve_items_in_similar_orders_node": {
      "id": "34961203",
      "type": "APINode",
      "name": "Find items in similar orders",
      "url": "https://url.to.my.remote.api/orders/{{order_id}}/items_in_similar_orders",
      "http_method": "GET",
      "inputs": [
        {
          "title": "order_id",
          "description": "The order ID",
          "type": "string"
        }
      ],
      "outputs": [
        {
          "title": "possible_replacement_items",
          "description": "The list of items in similar order",
          "type": "array",
          "default": [],
          "items": {
            "type": "object",
            "additionalProperties": {
              "type": "string"
            }
          }
        }
      ]
    },
    "get_items_that_are_eligible_replacements_node": {
      "id": "5k12h31257",
      "type": "MapNode",
      "name": "Get items that are eligible replacements",
      "subflow": "check_item_is_eligible_replacement_flow",
      "inputs": [
        {
          "title": "order",
          "description": "The order information as a dictionary",
          "type": "object",
          "additionalProperties": {
            "type": "string"
          }
        },
        {
          "title": "possible_replacement_items",
          "description": "The list of items in similar order",
          "type": "array",
          "default": [],
          "items": {
            "type": "object",
            "additionalProperties": {
              "type": "string"
            }
          }
        }
      ],
      "outputs": [
        {
          "title": "eligible_items_list",
          "description": "The list of items eligible as replacements in this order",
          "type": "array",
          "default": [],
          "items": {
            "type": "object",
            "additionalProperties": {
              "type": "string"
            }
          }
        }
      ]
    },

    // ...


    // Flow edges

    "start_to_retrieve_order_info": {
      "id": "ff474101",
      "type": "ControlFlowEdge",
      "from_node": {
        "$ref": "start_node"
      },
      "to_node": {
        "$ref": "retrieve_order_info_node"
      }
    },
    "retrieve_order_info_to_is_order_eligible_for_replacement": {
      "id": "a4a6bdb0",
      "type": "ControlFlowEdge",
      "from_node": {
        "$ref": "retrieve_order_info_node"
      },
      "to_node": {
        "$ref": "is_order_eligible_for_replacement_node"
      }
    },
    "is_order_eligible_for_replacement_to_next_nodes": {
      "id": "a4a6bdb0",
      "type": "ConditionalControlFlowEdge",
      "from_node": {
        "$ref": "is_order_eligible_for_replacement_node"
      },
      "mapping": {
        "true": "retrieve_items_in_similar_orders_node",
        "false": "generate_and_output_rejection_reason"
      },
      "inputs": [
        {
          "title": "is_eligible",
          "description": "Yes if the order is eligible for replacement, No otherwise",
          "type": "string"
        }
      ],
      "outputs": []
    },

    // ...

    // I/O edges

    "order_id_edge": {
      "id": "a57c10f2",
      "type": "DataFlowEdge",
      "source_node": {
        "$ref": "start_node"
      },
      "source_output": "order_id",
      "destination_node": {
        "$ref": "retrieve_order_info_node"
      },
      "destination_input": "order_id"
    },
    "order_info_edge": {
      "id": "92c75f51",
      "type": "DataFlowEdge",
      "source_node": {
        "$ref": "retrieve_order_info_node"
      },
      "source_output": "order",
      "destination_node": {
        "$ref": "is_order_eligible_for_replacement_node"
      },
      "destination_input": "order"
    },

    // ...

    // Flow

    "find_order_replacement_flow": {
      "id": "abcdefgh",
      "type": "Flow",
      "name": "Find order replacement",
      "start_node": {
        "$ref": "start_node"
      },
      "nodes": [
        {
          "$ref": "start_node"
        },
        {
          "$ref": "end_node"
        },
        {
          "$ref": "retrieve_order_info_node"
        },
        {
          "$ref": "is_order_eligible_for_replacement_node"
        },
        {
          "$ref": "retrieve_items_in_similar_orders_node"
        },
        {
          "$ref": "get_items_that_are_eligible_replacements_node"
        }
        // ...
      ],
      "control_flow_connections": [
        {
          "$ref": "start_to_retrieve_order_info"
        },
        {
          "$ref": "retrieve_order_info_to_is_order_eligible_for_replacement"
        }
        // ...
      ],
      "data_flow_connections": [
        {
          "$ref": "order_id_edge"
        },
        {
          "$ref": "order_info_edge"
        }
        // ...
      ],
      "inputs": [
        {
          "title": "order_id",
          "description": "The order ID",
          "type": "string"
        }
      ],
      "outputs": [
        {
          "title": "eligible_items_list",
          "description": "The list of items eligible as replacements in this order",
          "type": [
            "array",
            null
          ],
          "default": null,
          "items": {
            "type": "object",
            "additionalProperties": {
              "type": "string"
            }
          }
        }
      ]
    }
  },
  "agentspec_version": "25.4.1"
}
